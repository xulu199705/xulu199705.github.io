{"title":"从零开始的客制化87键机械键盘_2_硬件设计","uid":"49a2c5d17b4d7f50cd6d0ff2b91bb9ae","slug":"keyboard87-2","date":"2019-01-22T05:24:30.000Z","updated":"2022-11-22T09:37:42.213Z","comments":true,"path":"api/articles/keyboard87-2.json","keywords":null,"cover":[],"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>前文：<br>\n<a href=\"/2018/12/25/keyboard87-1/\">从零开始的客制化87键机械键盘_1_立项</a></p></blockquote>\n<p>从这个项目立项以来已经快一个月了，终于在师傅和同学的帮助下，搞定了硬件设计。下面我就器件选型简单介绍一下，最后贴了一下渲染图。</p>\n<span id=\"more\"></span>\n<h2 id=\"硬件设计\">1 硬件设计</h2>\n<p>这一章介绍一下客制化键盘的硬件设计，包括以下4项：主控芯片、传输接口、轴体选择、键盘布局。</p>\n<h3 id=\"主控芯片\">1.1 主控芯片</h3>\n<p>在确定STM32作为主控芯片之前，我在网上搜了一下，也拆了手上的ikbc\nC87，ATMEL的ATMEGA32芯片使用的比较多。我最终还是选择了STM32，主要原因是对STM32比较熟悉。</p>\n<p>当然，作为32位的MCU，STM32不管是在IO数量、USB接口支持，还是程序运算速度，都能满足机械键盘的需求。</p>\n<ul>\n<li>USB接口</li>\n</ul>\n<p>机械键盘使用时是作为USB\nSlave使用的，所以只需要芯片支持USB就行，不需要OTG。STM32F1的所有芯片都支持全速USB\n2.0，所以随便选一款就行。</p>\n<ul>\n<li>IO数量</li>\n</ul>\n<p>简单计算一下机械键盘需要的IO口，见下表（实际IO分配以实际原理图为准）。</p>\n<table>\n<colgroup>\n<col style=\"width: 25%\">\n<col style=\"width: 25%\">\n<col style=\"width: 25%\">\n<col style=\"width: 25%\">\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th>序号</th>\n<th>用途</th>\n<th>数量</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>1</td>\n<td>键盘列</td>\n<td>17</td>\n<td>87键键盘布局，最多的一行（第2行）共17个按键</td>\n</tr>\n<tr class=\"even\">\n<td>2</td>\n<td>键盘行</td>\n<td>6</td>\n<td>87键键盘布局，共6行</td>\n</tr>\n<tr class=\"odd\">\n<td>3</td>\n<td>USB接口</td>\n<td>2</td>\n<td>USBDN和USBDP</td>\n</tr>\n<tr class=\"even\">\n<td>4</td>\n<td>调试接口</td>\n<td>2</td>\n<td>使用STLink连接，仅需JTMS-SWDIO、JTCK-SWCLK和GND三个接口</td>\n</tr>\n</tbody>\n</table>\n<p>简单计算一下，键盘需求的IO口为27个。</p>\n<ul>\n<li>运算速度</li>\n</ul>\n<p>STM32有四个时钟源：</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th>时钟源</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>高速外部时钟(HSE)</td>\n<td>可取4-16MHz，一般采用8MHz</td>\n</tr>\n<tr class=\"even\">\n<td>高速内部时钟(HSI)</td>\n<td>8MHz，内部RC振荡器产生，不稳定</td>\n</tr>\n<tr class=\"odd\">\n<td>低速外部时钟(LSE)</td>\n<td>外部晶振，一般采用32.768KHz</td>\n</tr>\n<tr class=\"even\">\n<td>低速内部时钟(LSI)</td>\n<td>内部RC振荡器产生，约40KHz</td>\n</tr>\n</tbody>\n</table>\n<p>机械键盘用8MHz外部晶振，内部的系统时钟最高为72MHz，满足机械键盘的输入精度要求。</p>\n<h3 id=\"传输接口\">1.2 传输接口</h3>\n<p>机械键盘的传输接口已经确定为USB。一般来说，USB有以下几种接口类型：</p>\n<table>\n<colgroup>\n<col style=\"width: 20%\">\n<col style=\"width: 20%\">\n<col style=\"width: 20%\">\n<col style=\"width: 20%\">\n<col style=\"width: 20%\">\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: center;\">Type A</th>\n<th style=\"text-align: center;\">Type B</th>\n<th style=\"text-align: center;\">Mini</th>\n<th style=\"text-align: center;\">Micro</th>\n<th style=\"text-align: center;\">Type C</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><img src=\"/post/keyboard87-2.htm/3082159515.jpg\" alt=\"type_a\"></td>\n<td style=\"text-align: center;\"><img src=\"/post/keyboard87-2.htm/3927602725.jpg\" alt=\"type_b\"></td>\n<td style=\"text-align: center;\"><img src=\"/post/keyboard87-2.htm/1301417559.jpg\" alt=\"miniusb\"></td>\n<td style=\"text-align: center;\"><img src=\"/post/keyboard87-2.htm/3726218615.jpg\" alt=\"microusb\"></td>\n<td style=\"text-align: center;\"><img src=\"/post/keyboard87-2.htm/1494934121.jpg\" alt=\"type_c\"></td>\n</tr>\n</tbody>\n</table>\n<p>目前现在市面上键线分离的机械键盘一般用的是miniUSB或microUSB接口。最近半年来，USB\nC-type特别流行。这个接口不仅提供大功率传输，而且支持正反随便插，大大降低了插第二次的郁闷。机械键盘就决定用USB\nC-type。</p>\n<h3 id=\"轴体选择\">1.3 轴体选择</h3>\n<p>在选择机械键盘的轴体时，因为正在使用的ikbc\nC87，所以直接就决定用樱桃的MX轴。常用的MX轴有黑青茶红四种，茶轴肯定是我的首选，不管用做什么，都可以满足要求。</p>\n<p>MX轴的封装尺寸：<a href=\"https://github.com/xulu199705/KeyBoard87/tree/master/Reference/Cherry_MX/Cherry_MX_sw.pdf\">PDF</a></p>\n<h3 id=\"键盘布局\">1.4 键盘布局</h3>\n<p>键盘布局选择和手头使用的ikbc c87一样的87键布局，在<a href=\"http://www.keyboard-layout-editor.com/\">这里</a>可以将需要的布局信息生成一堆文本，将文本复制到<a href=\"http://builder.swillkb.com/\">这里</a>，生成定位板文件，方面在PCB中定位每个键轴的位置。</p>\n<p>布线图 <img src=\"/post/keyboard87-2.htm/1178723672.png\" alt=\"pcb_2d_bottomlayer.png\"></p>\n<table>\n<thead>\n<tr class=\"header\">\n<th>3D顶部视图</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><img src=\"/post/keyboard87-2.htm/1617787578.png\" alt=\"2.PNG\"></td>\n<td><img src=\"/post/keyboard87-2.htm/2508825578.png\" alt=\"pcb_3d_top.png\"></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr class=\"header\">\n<th>3D底部视图</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><img src=\"/post/keyboard87-2.htm/784997014.png\" alt=\"1.PNG\"></td>\n<td><img src=\"/post/keyboard87-2.htm/210904615.png\" alt=\"pcb_3d_bottom.png\"></td>\n</tr>\n</tbody>\n</table>\n<p>LOGO视图 <img src=\"/post/keyboard87-2.htm/2778683646.png\" alt=\"pcb_3d_logo.png\"></p>\n<p>P.S. PCB文件已上传<a href=\"https://github.com/xulu199705/KeyBoard87\">github</a>，过一会儿就投板给嘉立创打样。</p>\n","text":" 前文： 从零开始的客制化87键机械键盘_1_立项 从这个项目立项以来已经快一个月了，终于在师傅和同学的帮助下，搞定了硬件设计。下面我就器件选型简单介绍一下，最...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"硬件","slug":"硬件","count":5,"path":"api/categories/硬件.json"}],"tags":[{"name":"STM32","slug":"STM32","count":4,"path":"api/tags/STM32.json"},{"name":"键盘","slug":"键盘","count":3,"path":"api/tags/键盘.json"},{"name":"DIY","slug":"DIY","count":5,"path":"api/tags/DIY.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A1%AC%E4%BB%B6%E8%AE%BE%E8%AE%A1\"><span class=\"toc-text\">1 硬件设计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E6%8E%A7%E8%8A%AF%E7%89%87\"><span class=\"toc-text\">1.1 主控芯片</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BC%A0%E8%BE%93%E6%8E%A5%E5%8F%A3\"><span class=\"toc-text\">1.2 传输接口</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BD%B4%E4%BD%93%E9%80%89%E6%8B%A9\"><span class=\"toc-text\">1.3 轴体选择</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%94%AE%E7%9B%98%E5%B8%83%E5%B1%80\"><span class=\"toc-text\">1.4 键盘布局</span></a></li></ol></li></ol>","author":{"name":"Leon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/17242727?s=60&v=4","link":"/","description":"这里是爱研究各种问题、立许多flag的Leon的网络日志","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"从零开始的客制化87键机械键盘_3_PCB打样","uid":"8c19471874a69aaddb8fed8803402e5b","slug":"keyboard87-3","date":"2019-01-28T12:14:30.000Z","updated":"2022-11-22T09:37:23.264Z","comments":true,"path":"api/articles/keyboard87-3.json","keywords":null,"cover":[],"text":" 前文： 从零开始的客制化87键机械键盘_1_立项 从零开始的客制化87键机械键盘_2_硬件设计 机械键盘的原理图搞定之后就投去打样了，这次体验还是不错。 1 ...","link":"","photos":[],"count_time":{"symbolsCount":285,"symbolsTime":"1 mins."},"categories":[{"name":"硬件","slug":"硬件","count":5,"path":"api/categories/硬件.json"}],"tags":[{"name":"STM32","slug":"STM32","count":4,"path":"api/tags/STM32.json"},{"name":"键盘","slug":"键盘","count":3,"path":"api/tags/键盘.json"},{"name":"DIY","slug":"DIY","count":5,"path":"api/tags/DIY.json"}],"author":{"name":"Leon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/17242727?s=60&v=4","link":"/","description":"这里是爱研究各种问题、立许多flag的Leon的网络日志","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"从零开始的客制化87键机械键盘_1_立项","uid":"d1828fe679e46c6ff31652ba67ef65f8","slug":"keyboard87-1","date":"2018-12-25T12:24:41.000Z","updated":"2022-11-22T09:37:45.764Z","comments":true,"path":"api/articles/keyboard87-1.json","keywords":null,"cover":[],"text":"还有半年就要毕业了，在做毕业设计之余，我准备客制化一个87键机械键盘。键盘用STM32做主控，USB type-C做接口，以基本操作为最低目标。当然了，由于主专...","link":"","photos":[],"count_time":{"symbolsCount":455,"symbolsTime":"1 mins."},"categories":[{"name":"硬件","slug":"硬件","count":5,"path":"api/categories/硬件.json"}],"tags":[{"name":"STM32","slug":"STM32","count":4,"path":"api/tags/STM32.json"},{"name":"键盘","slug":"键盘","count":3,"path":"api/tags/键盘.json"},{"name":"DIY","slug":"DIY","count":5,"path":"api/tags/DIY.json"}],"author":{"name":"Leon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/17242727?s=60&v=4","link":"/","description":"这里是爱研究各种问题、立许多flag的Leon的网络日志","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}